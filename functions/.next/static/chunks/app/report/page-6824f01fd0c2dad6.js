(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[81],{2191:(e,a,t)=>{Promise.resolve().then(t.bind(t,5140))},5140:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>n});var r=t(5155),s=t(2115),o=t(4595),c=t(7058),i=t(6046);function n(){let e="testUser123",[a,t]=(0,s.useState)(null),[n,p]=(0,s.useState)([]),[l,d]=(0,s.useState)(!0),u=(0,i.useRouter)();(0,s.useEffect)(()=>{(async()=>{try{let a=(0,c.H9)(o.db,"users",e),r=await (0,c.x7)(a);if(r.exists()){let a=r.data(),s=m(a.companyLocation),i=[{emission_factor:{activity_id:"electricity-supply_grid-source_supplier_mix",source:"BEIS",region:s,year:2024,source_lca_activity:"electricity_generation",data_version:"^20"},parameters:{energy:parseFloat(a.electricity)||1e3,energy_unit:"kWh"}},{emission_factor:{activity_id:"homeworking-type_office_equipment_and_heating",source:"BEIS",region:s,year:2024,source_lca_activity:"unknown",data_version:"^20"},parameters:{time:880*(parseInt(a.employees)||10),time_unit:"h"}}],n=await fetch("https://api.climatiq.io/batch",{method:"POST",headers:{Authorization:"Bearer ".concat("RG7SCBDXEX2T985YFR4HSJQ384"),"Content-Type":"application/json"},body:JSON.stringify(i)}),l=await n.json();t(l);let d=[{scope:"Scope 2",scopeCategory:"0",scopeCategoryName:"Electricity",dataSource:"BEIS"},{scope:"Scope 3",scopeCategory:"7",scopeCategoryName:"Homeworking",dataSource:"BEIS"}],u=l.results.map((e,a)=>({scope:d[a].scope,scopeCategory:d[a].scopeCategory,scopeCategoryName:d[a].scopeCategoryName,kgCO2e:e.co2e||0,dataSource:d[a].dataSource}));p(u),await (0,c.BN)((0,c.H9)(o.db,"users",e),{emissionsReport:u},{merge:!0})}}catch(e){console.error("Error generating report:",e)}finally{d(!1)}})()},[]);let m=e=>({UK:"GB",USA:"US",Germany:"DE"})[e]||"GB";return l?(0,r.jsx)("p",{children:"Loading report..."}):(0,r.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"Company Emissions Report"}),n.length>0?(0,r.jsx)("div",{className:"bg-white p-4 shadow rounded-md",children:n.map((e,a)=>(0,r.jsxs)("div",{className:"mb-4 border-b pb-2",children:[(0,r.jsx)("h2",{className:"font-bold text-xl",children:e.scopeCategoryName}),(0,r.jsxs)("p",{children:["Scope: ",e.scope]}),(0,r.jsxs)("p",{children:["Category: ",e.scopeCategory]}),(0,r.jsxs)("p",{children:["Emissions: ",e.kgCO2e," kgCOâ‚‚e"]}),(0,r.jsxs)("p",{children:["Data Source: ",e.dataSource]})]},a))}):(0,r.jsx)("p",{children:"No report data available."}),(0,r.jsx)("button",{onClick:()=>u.push("/"),className:"mt-4 px-6 py-2 bg-primary text-white rounded-md hover:bg-secondary",children:"Back to Home"})]})}},4595:(e,a,t)=>{"use strict";t.d(a,{db:()=>i});var r=t(9904),s=t(7058),o=t(6553);let c=(0,r.Wp)({apiKey:"AIzaSyC60LuBu3ETiG2YVaf_vg_Vhd87HVwr4ek",authDomain:"business-carbon-calculator.firebaseapp.com",projectId:"business-carbon-calculator",storageBucket:"business-carbon-calculator.firebasestorage.app",messagingSenderId:"986568118039",appId:"1:986568118039:web:7cde15ddd4c3a9e4233152",measurementId:"G-MKGVFLG0E3"}),i=(0,s.aU)(c);(0,o.TT)().then(e=>{e&&(0,o.P5)(c)}).catch(e=>console.error("Analytics init error:",e))}},e=>{var a=a=>e(e.s=a);e.O(0,[992,691,441,517,358],()=>a(2191)),_N_E=e.O()}]);